# C 与 C++ 程序设计实验报告

> 电子科技大学 计算机科学与工程系
> 潘振宇
> 2014060105015

## 目标用户

交作业的

## 实现的需求

实现了基础需求……没有关卡

## 实现过程中的问题

使用 Clion 作为 IDE，主体开发环境为 Archlinux。

### 安装依赖

    $ pacman -S sfml

> Archlinux 遵循不分包的原则，所以只要下载安装一个包就可以了。  
> 如果目标平台是 Ubuntu 等发行可能还需要 `sfml-dev` 等包来准备必须的头文件等。

### 环境配置

Clion 使用 `cmake` 作为构建环境。同时 `sfml` 的发行中也提供了 `cmake` 的支持。

所以只需要根据官网说明修改 `CMakeList.txt` 中的内容即可

> 注意到 Clion 有一个 `Feature as bug` 的问题，默认在构建时，会拷贝所有文件到一个新的临时目录，然后从头构建。比较消耗时间。  
> 存在的解决方案是在 CMakeList.txt 中定义 `CMAKE_RUNTIME_OUTPUT_DIRECTORY`  
> 不过目前的代码里是硬编码了目录  

### 代码风格

最近比较忙……暂时没有时间重构

预想的计划应该对于全部的**非重要资源**全部抽出定义。同时划分文件模块来*减少集成构建时间*。

然后写点测试嘛（一定不会写

实现了一些控制反转的设计原则（然而并没有什么卵用

没有设计自己的基类……因为目前用不着

UML没有画，因为用不着

#### C11 Feature

比较多的使用了 C++11 的新语言特性

不完全列表：

1. Lambda 表达式
2. share_ptr 智能指针
3. 同时还有 C++11 为容器带来的一些操作: `remove_if`
4. 大量的使用了 C++11 的 range-based 迭代器循环
5. auto 自动进行类型推导，虽然声明的时候少不了，但是可以很大的减少击键次数。

> 很有些函数式语言的味道，虽然受制于 C++ 的历史包袱，这些特性用起来并没有在其他语言中舒服，语法层面上的 Overload 过重。

### 扩展性

感觉应该还是可以满足要加关卡的需求的……部分实现上需要小修改

### 评价

两个字*能用*

效率方面……反正就这点操作一般正常情况都可以运行，其实还有几个循环可以合并（（（不过合并了之后 lambda 函数就得很长了……（现在也不短

因为使用了智能指针应该也不会有内存泄露的情况出现，不过有很多的资源是预加载的而不是按需加载的所以总的占用估计不可能很小

## 可能的扩展

> 出现啦，无止境的需求

### 实现

* 更多的运用share_ptr。
* 对于资源使用工厂函数的方式动态加载（从内存中或者从磁盘中，封装加载细节）
* 渲染方面可能使用分块更新的方式

### 逻辑

* 一开始是基于事件的API来写的，后来我们发现这会拖慢按键检测的速度，同时在按键检测的时候的体验并不好
* 对于主事件循环可能按照逻辑尽可能的分拆成对函数的调用
